NNNNNN W01-WRITE-DEP-JRNL.       
NNNNNN INITIALIZE WA-CURR-BAL
NNNNNN            JNRST-DB-DATA
NNNNNN     IF INVM-CURR-BAL < 0
NNNNNN       MOVE INVM-CURR-BAL       TO WA-CURR-BAL
NNNNNN     ELSE
NNNNNN       MULTIPLY -1 BY INVM-CURR-BAL
NNNNNN                            GIVING WA-CURR-BAL
NNNNNN     END-IF
NNNNNN     MOVE 98904                      TO JNRST-TRAN-CODE
NNNNNN                                        LINK-IN-TXCODE.
NNNNNN     MOVE 02                         TO LINK-IN-CALL-CODE.
NNNNNN     MOVE STRT-AREA-SOC-NO           TO LINK-IN-SOC-NO.
NNNNNN     CALL "UT0250" USING   WA-UT0250-AREA.
NNNNNN     IF LINK-OUT-STAT NOT = "****"
NNNNNN        MOVE 155      TO UTRARL-OUTPUT-ERR-MSG-NO
NNNNNN        MOVE 1        TO WA-MSG-ERR-FLAG
NNNNNN        MOVE "ERR"    TO UTRARL-OUTPUT-STATUS
NNNNNN        MOVE SPACES   TO UT8500CA-INPUT-MSG
NNNNNN        STRING "UTRARL(W01-WRITE-DEP-JRNL):98904 NOT FOUND"
NNNNNN        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NNNNNN        PERFORM A700-UT8500       THRU A700-EXIT
NNNNNN        GO TO W01-EXIT
NNNNNN     END-IF
NNNNNN     MOVE STRT-AREA-MSG-TIME         TO JNRST-TIME.
NNNNNN     MOVE INVM-KEY                   TO JNRST-KEY.
NNNNNN     MOVE "INV"                      TO JNRST-SYST.
NNNNNN     MOVE 01                         TO JNRST-TRN-TYP.
NNNNNN     MOVE ZERO                       TO JNRST-THREAD.
NNNNNN     MOVE STRT-AREA-POST-DT          TO JNRST-POST-DATE.
NNNNNN     MOVE INVM-BRANCH-NO             TO JNRST-BRCH.
NNNNNN     MOVE STRT-AREA-TERM-NO          TO JNRST-TERMNL.
NNNNNN     MOVE STRT-AREA-TELL-NO          TO JNRST-TELLER.
NNNNNN     MOVE STRT-AREA-POST-DT          TO JNRST-TRAN-DATE.
NNNNNN     MOVE STRT-AREA-JRNL-NO          TO JNRST-JRNL-NO.
NNNNNN     MOVE STRT-AREA-XCURR-IND        TO JNRST-XCURR-IND.
NNNNNN     MOVE 0                          TO JNRST-NEW-ACC-FLG.
NNNNNN     MOVE INVM-BRANCH-NO             TO JNRST-HOME-BRNCH.
NNNNNN     MOVE INVM-CURRENCY              TO JNRST-CURRENCY-CODE.
NNNNNN     MOVE INVM-ACCT-TYPE             TO JNRST-ACC-TYPE.
NNNNNN     MOVE INVM-INT-CAT               TO JNRST-INT-CAT.
NNNNNN     MOVE INVM-LST-FIN-DT            TO JNRST-LST-FIN-DT
NNNNNN     MOVE INVM-TRAP                  TO JNRST-TRAP
NNNNNN     MOVE ZERO                       TO JNRST-LIM-TOL-FLAG.
NNNNNN     MOVE SPACE                      TO JNRST-ATM-SAF-FLAG.
NNNNNN     MOVE ZERO                       TO JNRST-BOR-GROUP.
NNNNNN     MOVE ZERO                       TO JNRST-CHQ-DAYS.
NNNNNN     MOVE ZERO                       TO JNRST-BATCH-NO.
NNNNNN     MOVE ZERO                       TO JNRST-TAX-VAL
NNNNNN                                        JNRST-FID-EXEMPT-CODE.
NNNNNN     MOVE ZERO                       TO JNRST-FEE-TYPE
NNNNNN                                        JNRST-ERR-MSG
NNNNNN                                        JNRST-EXEMPT.
NNNNNN     MOVE ZERO                       TO JNRST-OVERRIDE-HDR-NO.
NNNNNN     MOVE SPACE                      TO JNRST-CHQ-FACILITY.
NNNNNN     MOVE ZERO                       TO JNRST-SOC-TAX
NNNNNN                                        JNRST-FLOAT
NNNNNN                                        JNRST-INT-BON-AVAIL
NNNNNN                                        JNRST-INT-BON-INCR
NNNNNN                                        JNRST-INT-BON-PROJ.
NNNNNN     MOVE LOW-VALUES                 TO JNRST-TOT-NO-TRNS.
NNNNNN     MOVE ZERO                       TO JNRST-CLOSE-INT.
NNNNNN   INITIALIZE JNRST-DATA-2-R.        
NNNNNN     MOVE ZEROES                     TO JNRST-TOM-CR-ACRU
NNNNNN                                        JNRST-TOM-DR-ACRU.
NNNNNN   INITIALIZE JNRST-OD-DATA.         
NNNNNN     MOVE 1                          TO JNRST-FLAG.
NNNNNN   INITIALIZE JNRST-ERR-FLAGS.     
NNNNNN     MOVE ZERO                       TO JNRST-TO-BASE-EQUIVALENT.
NNNNNN     MOVE SPACE                      TO JNRST-TO-CURRENCY-CODE.
NNNNNN     MOVE 1                          TO JNRST-FROM-CURRENCY-RATE
NNNNNN                                        JNRST-TO-CURRENCY-RATE.
NNNNNN     MOVE ZERO                       TO JNRST-ERR-GLST-FLG
NNNNNN                                        JNRST-CURR-COMMISSION
NNNNNN                                        JNRST-CURR-CHANGE
NNNNNN                                        JNRST-RATE-TYPE
NNNNNN                                        JNRST-TO-CURR-AMOUNT.
NNNNNN     MOVE ZERO                       TO JNRST-MCURR-TRAN-CODE
NNNNNN                                        JNRST-TRANSFER-TXN-BRANCH
NNNNNN                                        JNRST-ERR-CTST-FLG
NNNNNN                                        JNRST-BOR-SUB-GROUP.
NNNNNN     MOVE SPACES                     TO JNRST-ORIGINAL-TXN-IND.
NNNNNN     MOVE WA-CURR-BAL                TO JNRST-TO-BASE-EQUIVALENT
NNNNNN                                        JNRST-TO-CURR-AMOUNT.
NNNNNN     MOVE 8880                       TO JNRST-MCURR-TRAN-CODE.
NNNNNN     MOVE INVM-BRANCH-NO             TO JNRST-TRANSFER-TXN-BRANCH.
NNNNNN     MOVE GL-CLASS-CODE              TO JNRST-GL-CLASS-CODE.
NNNNNN     MOVE RA-CLASS-CODE              TO JNRST-XFER-GL-CLASS-CODE.
NNNNNN     MOVE SPACES                     TO JNRST-CGL-POSTING-IND.
NNNNNN     MOVE INVM-ACCT-TYPE             TO JNRST-GL-ACC-TYPE.
NNNNNN     MOVE INVM-INT-CAT               TO JNRST-INT-CAT.
NNNNNN     MOVE  1                         TO JNRST-RATE-TYPE.
NNNNNN     MOVE "INV"                      TO JNRST-SYST.
NNNNNN     MOVE INVM-MEMB-CUST-AC          TO JNRST-CUSM-NO.
NNNNNN     MOVE ZEROES                     TO JNRST-TRANSFER-ACCT.
NNNNNN     MOVE 0                          TO JNRST-TRANSFER-TRAN-CODE.
NNNNNN     MOVE INVM-CURRENCY              TO JNRST-TO-CURRENCY-CODE.
NNNNNN     MOVE SPACES                     TO JNRST-CURRENCY-CODE.
NNNNNN     MOVE LINK-EDIT-TABLE            TO JNRST-EDIT-MASK.
NNNNNN     MOVE 8880                       TO JNRST-TRAN-CODE.
NNNNNN     MOVE WA-CURR-BAL                TO JNRST-BALANCE.
NNNNNN     MOVE WA-CURR-BAL                TO JNRST-AMOUNT
NNNNNN     MOVE WA-CURR-BAL                TO JNRST-FROM-BASE-EQUIVALENT.
NNNNNN     MOVE INVM-CUST-EVAL-FLAG        TO JNRST-CUST-EVAL-FLAG.
NNNNNN     MOVE 02                         TO SY0010CA-FUNC.
NNNNNN     CALL "SY0010"   USING SY0010-COMMON-AREA
NNNNNN                           WA-JRNL-CALL-AREA.
NNNNNN     IF  SY0010CA-STATUS NOT = 0
NNNNNN        MOVE 155      TO UTRARL-OUTPUT-ERR-MSG-NO
NNNNNN        MOVE 1        TO WA-MSG-ERR-FLAG
NNNNNN        MOVE "JRNL"   TO UTRARL-OUTPUT-DATA-SET
NNNNNN        MOVE "ERR"    TO UTRARL-OUTPUT-STATUS
NNNNNN        MOVE SPACES   TO UT8500CA-INPUT-MSG
NNNNNN        STRING "UTRARL(W01-WRITE-DEP-JRNL):SY0010 CALL ERROR"
NNNNNN        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NNNNNN        PERFORM A700-UT8500       THRU A700-EXIT
NNNNNN     END-IF.
NNNNNN W01-EXIT.
NNNNNN EXIT.
